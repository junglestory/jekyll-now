<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>2019-04-17-electron-quick-start.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>.hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-dartdoc,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-type,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">
<hr class="section"><p>layout: post</p><h2 id="title:-electron-자동-업데이트"><a name="title:-electron-자동-업데이트" href="#title:-electron-자동-업데이트"></a>title: Electron 자동 업데이트</h2><p><strong>Electron</strong>에서는 <strong><a href="https://github.com/electron-userland/electron-builder">electron-updater</a></strong>로 자동업데이트를 할 수 있다. 자동업데이트는 macOS와 Windows에서 가능하지만,<br>macOS에서는 코드 사이닝이 필요하다. 이 포스팅에서는 <a href="(https://github.com/electron/electron-quick-start">보일러 플레이트</a>로 Windows에서 자동업데이트 방법을 설명한다.</p><h2 id="사전-준비"><a name="사전-준비" href="#사전-준비"></a>사전 준비</h2><p>Electron으로 만든 앱을 자동업데이트 받기 위해서는 업데이트 서버가 필요하다. 이 포스팅에서는 Github을 이용한 자동업데이트를 설명한다.<br>우선, Github계정이 필요하고, Github으로 배포 시 인증을 위한 Github Token이 필요하다.</p><ol>
<li>Github 계정이 없는 경우 <strong><a href="https://github.com/join?source=header-home">Github</a></strong> 홈페이지에서 회원 가입을 한다. </li><li><p>Github에 로그인 후 <strong>Settings &gt; Developer settiings &gt; Personal access tokens</strong> 에서 <strong>Github Token</strong> 을 생성한다.<br><img src="/images/electron-quick-start/token.png" alt="token"></p>
</li><li><p><strong><a href="https://nodejs.org/ko/download/">Node.js</a></strong> 설치한다.</p>
</li></ol><h2 id="프로젝트-생성"><a name="프로젝트-생성" href="#프로젝트-생성"></a>프로젝트 생성</h2><ol>
<li><p>Github에서 <strong><a href="https://github.com/electron/electron-quick-start">보일러 플레이트</a></strong> 프로젝트를 포크한다.<br><img src="/images/electron-quick-start/fork.png" alt="fork"></p>
</li><li><p>보일러 플레이트 프로젝트를 로컬에 생성한다.</p>
<pre><code data-origin="<pre><code> git clone https://github.com/&amp;lt;GITHUB 계정&amp;gt;/electron-quick-start
</code></pre>"> git clone https://github.com/&lt;GITHUB 계정&gt;/electron-quick-start
</code></pre></li><li><p>생성된 프로젝트 폴더로 이동한다.</p>
<pre><code data-origin="<pre><code> cd electron-quick-start
</code></pre>"> cd electron-quick-start
</code></pre></li><li><p>라이브러리를 설치한다.</p>
<pre><code data-origin="<pre><code> npm install
</code></pre>"> npm install
</code></pre></li><li><p>프로젝트를 실행한다.</p>
<pre><code data-origin="<pre><code> npm start
</code></pre>"> npm start
</code></pre></li><li><p>프로젝트를 실행을 확인 후 종료한다.<br><img src="/images/electron-quick-start/helloworld.png" alt="helloworld">    </p>
</li></ol><h2 id="package.json-설정"><a name="package.json-설정" href="#package.json-설정"></a>Package.json 설정</h2><ol>
<li><p>“scripts” 에 실행 명령 설정을 추가한다. </p>
<pre><code data-origin="<pre><code>&quot;scripts&quot;: {
 &quot;start&quot;: &quot;electron .&quot;,
 &quot;publish&quot;: &quot;electron-builder --x64 —-win -p always&quot;,
 &quot;pack&quot;: &quot;electron-builder --dir&quot;,
 &quot;dist&quot;: &quot;electron-builder --x64 —-win&quot;
},
</code></pre>">"scripts": {
 "start": "electron .",
 "publish": "electron-builder --x64 —-win -p always",
 "pack": "electron-builder --dir",
 "dist": "electron-builder --x64 —-win"
},
</code></pre></li><li><p>Github에 배포를 하기위에 “repository” 설정의 type에는 git, url 에는 Github 주소를 설정한다.</p>
<pre><code data-origin="<pre><code>   &quot;repository&quot;: {
     &quot;type&quot;: &quot;git&quot;,
     &quot;url&quot;: &quot;https://github.com/&amp;lt;GITHUB 계정&amp;gt;/electron-quick-start&quot;
   },
</code></pre>">   "repository": {
     "type": "git",
     "url": "https://github.com/&lt;GITHUB 계정&gt;/electron-quick-start"
   },
</code></pre></li><li><p>“build” 설정을 추가한다.</p>
<pre><code data-origin="<pre><code>   &quot;build&quot;: {
     &quot;appId&quot;: &quot;app.electron.quick.start&quot;,
     &quot;productName&quot;: &quot;electron-quick-start&quot;,
     &quot;artifactName&quot;: &quot;${productName}-setup-${version}.${ext}&quot;,
     &quot;publish&quot;: {
         &quot;provider&quot;: &quot;github&quot;,
         &quot;owner&quot;: &quot;&amp;lt;GITHUB 계정&amp;gt;&quot;,
         &quot;repo&quot;: &quot;electron-quick-start&quot;
     }
   },
</code></pre>">   "build": {
     "appId": "app.electron.quick.start",
     "productName": "electron-quick-start",
     "artifactName": "${productName}-setup-${version}.${ext}",
     "publish": {
         "provider": "github",
         "owner": "&lt;GITHUB 계정&gt;",
         "repo": "electron-quick-start"
     }
   },
</code></pre></li><li><p>인스톨러 생성을 위해 빌드 설정에 NSIS 설정을 추가한다.</p>
<pre><code data-origin="<pre><code>     ,
     &quot;nsis&quot;: {
       &quot;oneClick&quot;: false,
       &quot;allowToChangeInstallationDirectory&quot;: true
     }
</code></pre>">     ,
     "nsis": {
       "oneClick": false,
       "allowToChangeInstallationDirectory": true
     }
</code></pre></li></ol><h2 id="버전-정보-설정"><a name="버전-정보-설정" href="#버전-정보-설정"></a>버전 정보 설정</h2><ol>
<li><p>package.json 파일에서 설정한 버전 정보를 가져오기 위해서 main.js의 3라인에 아래 코드를 추가한다.</p>
<pre><code data-origin="<pre><code> global.sharedObj = {version: app.getVersion()};
</code></pre>"> global.sharedObj = {version: app.getVersion()};
</code></pre></li><li><p>화면에 버전 정보 출력을 위해 index.html의 12라인을 아래 코드로 변경한다.</p>
<pre><code data-origin="<pre><code> and Electron &amp;lt;script&amp;gt;document.write(process.versions.electron)&amp;lt;/script&amp;gt;,
 and Current &amp;lt;script&amp;gt; var remote = require('electron').remote; document.write(remote.getGlobal('sharedObj').version)&amp;lt;/script&amp;gt;.
</code></pre>"> and Electron &lt;script&gt;document.write(process.versions.electron)&lt;/script&gt;,
 and Current &lt;script&gt; var remote = require('electron').remote; document.write(remote.getGlobal('sharedObj').version)&lt;/script&gt;.
</code></pre></li><li><p>명령 프롬프트에서 <strong>npm start</strong> 를 실행해서 앱을 실행한다.</p>
<pre><code data-origin="<pre><code> nom start
</code></pre>"> nom start
</code></pre></li><li><p>버전을 확인 후 앱을 종료한다.<br><img src="/images/electron-quick-start/version.png" alt="version">    </p>
</li></ol><h2 id="자동-업데이트-설정"><a name="자동-업데이트-설정" href="#자동-업데이트-설정"></a>자동 업데이트 설정</h2><ol>
<li>명령 프롬프트에서 <strong>npm install electron-builder</strong> 를 실행해서 <strong>electron-builder</strong>를 설치한다. <pre><code data-origin="<pre><code> npm install electron-builder
</code></pre>"> npm install electron-builder
</code></pre></li><li><p>package.json 파일에서 <strong>“electron-builder”</strong> 설정을 <strong>“devDependencies”</strong> 로 이동한다.</p>
<p><strong>이동 전</strong></p>
<pre><code data-origin="<pre><code>&quot;dependencies&quot;: {
 &quot;electron-builder&quot;: &quot;^20.39.0&quot;,
}
`
</code></pre>">"dependencies": {
 "electron-builder": "^20.39.0",
}
`
</code></pre><p><strong>이동 후</strong></p>
<pre><code data-origin="<pre><code>&quot;devDependencies&quot;: {
 &quot;electron&quot;: &quot;^4.0.2&quot;,
 &quot;electron-builder&quot;: &quot;^20.39.0&quot;
}
</code></pre>">"devDependencies": {
 "electron": "^4.0.2",
 "electron-builder": "^20.39.0"
}
</code></pre></li><li><p>명령 프롬프트에서 <strong>npm install electron-updater</strong> 를 실행해서 <strong>electron-updater</strong>를 설치한다. </p>
<pre><code data-origin="<pre><code> npm install electron-updater
</code></pre>"> npm install electron-updater
</code></pre></li><li><p>main.js에 electron-updater 모듈을 추가한다.</p>
<pre><code data-origin="<pre><code> const {autoUpdater} = require(&quot;electron-updater&quot;);
</code></pre>"> const {autoUpdater} = require("electron-updater");
</code></pre></li><li><p>main.js에 updater 코드를 추가한다.</p>
<pre><code data-origin="<pre><code> autoUpdater.on('checking-for-update', () =&amp;gt; {
 })

 autoUpdater.on('update-available', (info) =&amp;gt; { 
   dialog.showMessageBox({
     type: 'question',
     buttons: ['Yes', 'No'],
     title: 'Update Ready',
     message: 'A new version of app is ready. Would you like to update?'
   }, (response) =&amp;gt; {
     if (response == 0) {
       autoUpdater.on('update-downloaded', (info) =&amp;gt; {
       autoUpdater.quitAndInstall();
       });
     } 
   });
 })

 autoUpdater.on('update-not-available', (info) =&amp;gt; {
 })

 autoUpdater.on('error', (err) =&amp;gt; {  
 })

 autoUpdater.on('download-progress', (progressObj) =&amp;gt; {    
 })

 app.on('ready', function()  {
   autoUpdater.checkForUpdatesAndNotify();
 });
</code></pre>"> autoUpdater.on('checking-for-update', () =&gt; {
 })

 autoUpdater.on('update-available', (info) =&gt; { 
   dialog.showMessageBox({
     type: 'question',
     buttons: ['Yes', 'No'],
     title: 'Update Ready',
     message: 'A new version of app is ready. Would you like to update?'
   }, (response) =&gt; {
     if (response == 0) {
       autoUpdater.on('update-downloaded', (info) =&gt; {
       autoUpdater.quitAndInstall();
       });
     } 
   });
 })

 autoUpdater.on('update-not-available', (info) =&gt; {
 })

 autoUpdater.on('error', (err) =&gt; {  
 })

 autoUpdater.on('download-progress', (progressObj) =&gt; {    
 })

 app.on('ready', function()  {
   autoUpdater.checkForUpdatesAndNotify();
 });
</code></pre></li></ol><h2 id="배포"><a name="배포" href="#배포"></a>배포</h2><ol>
<li><p>명령 프롬프트에서 <strong>GITHUB_TOKEN</strong>을 환경 변수로 설정한다.</p>
<pre><code data-origin="<pre><code> set GITHUB_TOKEN=&amp;lt;GITHUB 토큰&amp;gt;
</code></pre>"> set GITHUB_TOKEN=&lt;GITHUB 토큰&gt;
</code></pre></li><li><p>설치 파일 배포를 위해 명령 프롬프트에서 <strong>npm run publish</strong> 를 실행한다.</p>
<pre><code data-origin="<pre><code> npm run publish
</code></pre>"> npm run publish
</code></pre></li><li><p>Github에 로그인 한 후 electron-quick-start 프로젝트의 Releases 로 이동한다.<br><img src="/images/electron-quick-start/releases.png" alt="releases"></p>
</li><li><p>Releases에서 1.0.0 버전의 Edit 버튼을 클릭한다.<br><img src="/images/electron-quick-start/ediit.png" alt="edit"></p>
</li><li><p>Edit 페이지에서 Publish release 버튼을 클릭해서 1.0.0 버전을 Release 한다.<br><img src="/images/electron-quick-start/publish.png" alt="publish"></p>
</li><li><p>Github에서 설치 파일을 다운로드 받는다.<br><img src="/images/electron-quick-start/download.png" alt="download"></p>
</li><li><p>다운로드 받은 파일을 설치한다. 설치가 완료되면 마침 버튼을 클릭한다.<br><img src="/images/electron-quick-start/finished.png" alt="finished"></p>
</li><li><p>앱이 실행 되면 버전을 확인 후 앱을 종료한다.<br><img src="/images/electron-quick-start/100_install.png" alt="100_install"></p>
</li><li><p>package.json 파일에서 버전을 <strong>“1.0.1”</strong> 로 변경한다.</p>
<pre><code data-origin="<pre><code> &quot;version&quot;: &quot;1.0.1&quot;,
</code></pre>"> "version": "1.0.1",
</code></pre></li><li><p>배경을 검은색으로 보이기 위해서 index.html 에 style 을 추가한다.</p>
<pre><code data-origin="<pre><code>&amp;lt;style&amp;gt;
    body {
        background-color: black;
        color: white;
    }

    @media screen and (prefers-color-scheme: light) {
        body {
            background-color: white;
            color: black;
        }
    }
&amp;lt;/style&amp;gt;
</code></pre>">&lt;style&gt;
    body {
        background-color: black;
        color: white;
    }

    @media screen and (prefers-color-scheme: light) {
        body {
            background-color: white;
            color: black;
        }
    }
&lt;/style&gt;
</code></pre></li><li><p><strong>1.0.1</strong> 버전을 Github에 배포하기 위해 명령 프롬프트에서 <strong>npm run publish</strong> 를 실행한다.</p>
<pre><code data-origin="<pre><code>npm run publish
</code></pre>">npm run publish
</code></pre></li><li><p>Gihub에서 Releases 이동 후 1.0.1 버전의 Edit 버튼을 클릭한다.<br><img src="/images/electron-quick-start/ediit.png" alt="edit"></p>
</li><li><p>Edit 페이지에서 Publish release 버튼을 클릭해서 1.0.1 버전을 Release 한다.<br><img src="/images/electron-quick-start/101_publish.png" alt="101_publish"></p>
</li><li><p>Github에서 설치 파일을 다운로드 받는다.<br><img src="/images/electron-quick-start/101_download.png" alt="101_download"></p>
</li><li><p>앱을 실행한다. 업데이트 된 후 앱이 재 실행된다.<br><img src="/images/electron-quick-start/publish.png" alt="publish"></p>
</li><li><p>앱이 재 실행되면 변경된 배경화면과 버전을 확인 할 수 있다.<br><img src="/images/electron-quick-start/101_install.png" alt="101_install"></p>
</li></ol>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
